/*
 * ARM SMMUv2 support - Internal API
 *
 * Copyright (c) 2021 Semihalf sp. z o.o.
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 2 as
 * published by the Free Software Foundation.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License along
 * with this program; if not, see <http://www.gnu.org/licenses/>.
 */

#ifndef HW_ARM_SMMUV3_INTERNAL_H
#define HW_ARM_SMMUV3_INTERNAL_H

#include "hw/arm/smmu-common.h"
#include "hw/register.h"

/* MMIO Registers */

REG32(SMMU_SCR0, 0x0)
    FIELD(SMMU_SCR0, NSCFG, 28, 2)
    FIELD(SMMU_SCR0, WACFG, 26, 2)
    FIELD(SMMU_SCR0, RACFG, 24, 2)
    FIELD(SMMU_SCR0, SHCFG, 22, 2)
    FIELD(SMMU_SCR0, SMCFCFG, 21, 1)
    FIELD(SMMU_SCR0, MTCFG, 20, 1)
    FIELD(SMMU_SCR0, MEMATTR, 16, 4)
    FIELD(SMMU_SCR0, BSU, 14, 2)
    FIELD(SMMU_SCR0, FB, 13, 1)
    FIELD(SMMU_SCR0, PTM, 12, 1)
    FIELD(SMMU_SCR0, USFCFG, 10, 1)
    FIELD(SMMU_SCR0, GSE, 9, 1)
    FIELD(SMMU_SCR0, STALLD, 8, 1)
    FIELD(SMMU_SCR0, TRANSIENTCFG, 6, 2)
    FIELD(SMMU_SCR0, GCFGFIE, 5, 1)
    FIELD(SMMU_SCR0, GCFGFRE, 4, 1)
    FIELD(SMMU_SCR0, GFIE, 2, 1)
    FIELD(SMMU_SCR0, GFRE, 1, 1)
    FIELD(SMMU_SCR0, CLIENTPD, 0, 1)
REG32(SMMU_SCR1, 0x4)
    FIELD(SMMU_SCR1, NSCAFRO, 28, 1)
    FIELD(SMMU_SCR1, SPMEN, 27, 1)
    FIELD(SMMU_SCR1, SIF, 26, 1)
    FIELD(SMMU_SCR1, GEFRO, 25, 1)
    FIELD(SMMU_SCR1, GASRAE, 24, 1)
    FIELD(SMMU_SCR1, NSNUMIRPTO, 16, 8)
    FIELD(SMMU_SCR1, NSNUMSMRGO, 8, 6)
    FIELD(SMMU_SCR1, NSNUMCBO, 0, 5)
REG32(SMMU_SACR, 0x10)
    FIELD(SMMU_SACR, NORMALIZE, 27, 1)
    FIELD(SMMU_SACR, CACHE_LOCK, 26, 1)
    FIELD(SMMU_SACR, PAGESIZE, 16, 1)
    FIELD(SMMU_SACR, S2CRB_TLBEN, 10, 1)
    FIELD(SMMU_SACR, MMUDISB_TLBEN, 9, 1)
    FIELD(SMMU_SACR, SMTNMB_TLBEN, 8, 1)
    FIELD(SMMU_SACR, S1WC2EN, 2, 1)
REG32(SMMU_SIDR0, 0x20)
    FIELD(SMMU_SIDR0, SES, 31, 1)
    FIELD(SMMU_SIDR0, S1TS, 30, 1)
    FIELD(SMMU_SIDR0, S2TS, 29, 1)
    FIELD(SMMU_SIDR0, NTS, 28, 1)
    FIELD(SMMU_SIDR0, SMS, 27, 1)
    FIELD(SMMU_SIDR0, ATOSNS, 26, 1)
    FIELD(SMMU_SIDR0, PTFS, 24, 2)
    FIELD(SMMU_SIDR0, NUMIRPT, 16, 8)
    FIELD(SMMU_SIDR0, CTTW, 14, 1)
    FIELD(SMMU_SIDR0, BTM, 13, 1)
    FIELD(SMMU_SIDR0, NUMSIDB, 9, 4)
    FIELD(SMMU_SIDR0, NUMSMRG, 0, 8)
REG32(SMMU_SIDR1, 0x24)
    FIELD(SMMU_SIDR1, PAGESIZE, 31, 1)
    FIELD(SMMU_SIDR1, NUMPAGENDXB, 28, 3)
    FIELD(SMMU_SIDR1, NUMS2CB, 16, 8)
    FIELD(SMMU_SIDR1, SMCD, 15, 1)
    FIELD(SMMU_SIDR1, SSDTP, 12, 1)
    FIELD(SMMU_SIDR1, NUMSSDNDXB, 8, 4)
    FIELD(SMMU_SIDR1, NUMCB, 0, 8)
REG32(SMMU_SIDR2, 0x28)
    FIELD(SMMU_SIDR2, PTFSV8_64KB, 14, 1)
    FIELD(SMMU_SIDR2, PTFSV8_16KB, 13, 1)
    FIELD(SMMU_SIDR2, TFSV8_4KB, 12, 1)
    FIELD(SMMU_SIDR2, UBS, 8, 4)
    FIELD(SMMU_SIDR2, OAS, 4, 4)
    FIELD(SMMU_SIDR2, IAS, 0, 4)
REG32(SMMU_SIDR7, 0x3c)
    FIELD(SMMU_SIDR7, MAJOR, 4, 4)
    FIELD(SMMU_SIDR7, MINOR, 0, 4)
REG32(SMMU_SGFAR_LOW, 0x40)
REG32(SMMU_SGFAR_HIGH, 0x44)
    FIELD(SMMU_SGFAR_HIGH, FADDR, 0, 17)
REG32(SMMU_SGFSR, 0x48)
    FIELD(SMMU_SGFSR, MULTI, 31, 1)
    FIELD(SMMU_SGFSR, UUT, 8, 1)
    FIELD(SMMU_SGFSR, PF, 7, 1)
    FIELD(SMMU_SGFSR, EF, 6, 1)
    FIELD(SMMU_SGFSR, CAF, 5, 1)
    FIELD(SMMU_SGFSR, UCIF, 4, 1)
    FIELD(SMMU_SGFSR, UCBF, 3, 1)
    FIELD(SMMU_SGFSR, SMCF, 2, 1)
    FIELD(SMMU_SGFSR, USF, 1, 1)
    FIELD(SMMU_SGFSR, ICF, 0, 1)
REG32(SMMU_SGFSRRESTORE, 0x4c)
    FIELD(SMMU_SGFSRRESTORE, MULTI, 31, 1)
    FIELD(SMMU_SGFSRRESTORE, UUT, 8, 1)
    FIELD(SMMU_SGFSRRESTORE, PF, 7, 1)
    FIELD(SMMU_SGFSRRESTORE, EF, 6, 1)
    FIELD(SMMU_SGFSRRESTORE, CAF, 5, 1)
    FIELD(SMMU_SGFSRRESTORE, UCIF, 4, 1)
    FIELD(SMMU_SGFSRRESTORE, UCBF, 3, 1)
    FIELD(SMMU_SGFSRRESTORE, SMCF, 2, 1)
    FIELD(SMMU_SGFSRRESTORE, USF, 1, 1)
    FIELD(SMMU_SGFSRRESTORE, ICF, 0, 1)
REG32(SMMU_SGFSYNR0, 0x50)
    FIELD(SMMU_SGFSYNR0, ATS, 6, 1)
    FIELD(SMMU_SGFSYNR0, NSATTR, 5, 1)
    FIELD(SMMU_SGFSYNR0, NSSTATE, 4, 1)
    FIELD(SMMU_SGFSYNR0, IND, 3, 1)
    FIELD(SMMU_SGFSYNR0, PNU, 2, 1)
    FIELD(SMMU_SGFSYNR0, WNR, 1, 1)
REG32(SMMU_SGFSYNR1, 0x54)
    FIELD(SMMU_SGFSYNR1, SSD_INDEX, 16, 15)
    FIELD(SMMU_SGFSYNR1, STREAMID, 0, 15)
REG32(SMMU_STLBIALL, 0x60)
REG32(SMMU_TLBIVMID, 0x64)
    FIELD(SMMU_TLBIVMID, VMID, 0, 8)
REG32(SMMU_TLBIALLNSNH, 0x68)
REG32(SMMU_STLBGSYNC, 0x70)
REG32(SMMU_STLBGSTATUS, 0x74)
    FIELD(SMMU_STLBGSTATUS, GSACTIVE, 0, 1)
REG32(SMMU_DBGRPTRTBU, 0x80)
    FIELD(SMMU_DBGRPTRTBU, TBU_ID, 24, 3)
    FIELD(SMMU_DBGRPTRTBU, TLB_POINTER, 4, 12)
    FIELD(SMMU_DBGRPTRTBU, TLB_ENTRY_POINTER, 0, 4)
REG32(SMMU_DBGRDATATBU, 0x84)
REG32(SMMU_DBGRPTRTCU, 0x88)
    FIELD(SMMU_DBGRPTRTCU, DATASRC, 26, 2)
    FIELD(SMMU_DBGRPTRTCU, WAY_RAM, 24, 2)
    FIELD(SMMU_DBGRPTRTCU, TLB_POINTER, 4, 9)
    FIELD(SMMU_DBGRPTRTCU, TLB_ENTRY_POINTER, 0, 4)
REG32(SMMU_DBGRDATATCU, 0x8c)
REG32(SMMU_STLBIVALM_LOW, 0xa0)
REG32(SMMU_STLBIVALM_HIGH, 0xa4)
    FIELD(SMMU_STLBIVALM_HIGH, ADDRESS, 0, 5)
REG32(SMMU_STLBIVAM_LOW, 0xa8)
REG32(SMMU_STLBIVAM_HIGH, 0xac)
    FIELD(SMMU_STLBIVAM_HIGH, ADDRESS, 0, 5)
REG32(SMMU_STLBIALLM, 0xbc)
REG32(SMMU_NSCR0, 0x400)
    FIELD(SMMU_NSCR0, WACFG, 26, 2)
    FIELD(SMMU_NSCR0, RACFG, 24, 2)
    FIELD(SMMU_NSCR0, SHCFG, 22, 2)
    FIELD(SMMU_NSCR0, SMCFCFG, 21, 1)
    FIELD(SMMU_NSCR0, MTCFG, 20, 1)
    FIELD(SMMU_NSCR0, MEMATTR, 16, 4)
    FIELD(SMMU_NSCR0, BSU, 14, 2)
    FIELD(SMMU_NSCR0, FB, 13, 1)
    FIELD(SMMU_NSCR0, PTM, 12, 1)
    FIELD(SMMU_NSCR0, VMIDPNE, 11, 1)
    FIELD(SMMU_NSCR0, USFCFG, 10, 1)
    FIELD(SMMU_NSCR0, GSE, 9, 1)
    FIELD(SMMU_NSCR0, STALLD, 8, 1)
    FIELD(SMMU_NSCR0, TRANSIENTCFG, 6, 2)
    FIELD(SMMU_NSCR0, GCFGFIE, 5, 1)
    FIELD(SMMU_NSCR0, GCFGFRE, 4, 1)
    FIELD(SMMU_NSCR0, GFIE, 2, 1)
    FIELD(SMMU_NSCR0, GFRE, 1, 1)
    FIELD(SMMU_NSCR0, CLIENTPD, 0, 1)
REG32(SMMU_NSACR, 0x410)
    FIELD(SMMU_NSACR, CACHE_LOCK, 26, 1)
    FIELD(SMMU_NSACR, DP4K_TBUDISB, 25, 1)
    FIELD(SMMU_NSACR, DP4K_TCUDISB, 24, 1)
    FIELD(SMMU_NSACR, S2CRB_TLBEN, 10, 1)
    FIELD(SMMU_NSACR, MMUDISB_TLBEN, 9, 1)
    FIELD(SMMU_NSACR, SMTNMB_TLBEN, 8, 1)
    FIELD(SMMU_NSACR, IPA2PA_CEN, 4, 1)
    FIELD(SMMU_NSACR, S2WC2EN, 3, 1)
    FIELD(SMMU_NSACR, S1WC2EN, 2, 1)
REG32(SMMU_NSGFAR_LOW, 0x440)
REG32(SMMU_NSGFAR_HIGH, 0x444)
    FIELD(SMMU_NSGFAR_HIGH, FADDR, 0, 17)
REG32(SMMU_NSGFSR, 0x448)
    FIELD(SMMU_NSGFSR, MULTI, 31, 1)
    FIELD(SMMU_NSGFSR, UUT, 8, 1)
    FIELD(SMMU_NSGFSR, EF, 6, 1)
    FIELD(SMMU_NSGFSR, CAF, 5, 1)
    FIELD(SMMU_NSGFSR, UCIF, 4, 1)
    FIELD(SMMU_NSGFSR, UCBF, 3, 1)
    FIELD(SMMU_NSGFSR, SMCF, 2, 1)
    FIELD(SMMU_NSGFSR, USF, 1, 1)
    FIELD(SMMU_NSGFSR, ICF, 0, 1)
REG32(SMMU_NSGFSRRESTORE, 0x44c)
    FIELD(SMMU_NSGFSRRESTORE, MULTI, 31, 1)
    FIELD(SMMU_NSGFSRRESTORE, UUT, 8, 1)
    FIELD(SMMU_NSGFSRRESTORE, EF, 6, 1)
    FIELD(SMMU_NSGFSRRESTORE, CAF, 5, 1)
    FIELD(SMMU_NSGFSRRESTORE, UCIF, 4, 1)
    FIELD(SMMU_NSGFSRRESTORE, UCBF, 3, 1)
    FIELD(SMMU_NSGFSRRESTORE, SMCF, 2, 1)
    FIELD(SMMU_NSGFSRRESTORE, USF, 1, 1)
    FIELD(SMMU_NSGFSRRESTORE, ICF, 0, 1)
REG32(SMMU_NSGFSYNR0, 0x450)
    FIELD(SMMU_NSGFSYNR0, ATS, 6, 1)
    FIELD(SMMU_NSGFSYNR0, IND, 3, 1)
    FIELD(SMMU_NSGFSYNR0, PNU, 2, 1)
    FIELD(SMMU_NSGFSYNR0, WNR, 1, 1)
    FIELD(SMMU_NSGFSYNR0, NESTED, 0, 1)
REG32(SMMU_NSGFSYNDR1, 0x454)
    FIELD(SMMU_NSGFSYNDR1, SSD_INDEX, 16, 15)
    FIELD(SMMU_NSGFSYNDR1, STREAMID, 0, 15)
REG32(SMMU_NSTLBGSYNC, 0x470)
REG32(SMMU_NSTLBGSTATUS, 0x474)
    FIELD(SMMU_NSTLBGSTATUS, GSACTIVE, 0, 1)
REG32(SMMU_SMR0, 0x800)
    FIELD(SMMU_SMR0, VALID, 31, 1)
    FIELD(SMMU_SMR0, MASK, 16, 15)
    FIELD(SMMU_SMR0, ID, 0, 15)
REG32(SMMU_S2CR0, 0xc00)
    FIELD(SMMU_S2CR0, TRANSIENTCFG, 28, 2)
    FIELD(SMMU_S2CR0, INSTCFG_1, 27, 1)
    FIELD(SMMU_S2CR0, INSTCFG_0_FB, 26, 1)
    FIELD(SMMU_S2CR0, PRIVCFG_BSU, 24, 2)
    FIELD(SMMU_S2CR0, WACFG, 22, 2)
    FIELD(SMMU_S2CR0, RACFG, 20, 2)
    FIELD(SMMU_S2CR0, NSCFG, 18, 2)
    FIELD(SMMU_S2CR0, TYPE, 16, 2)
    FIELD(SMMU_S2CR0, MEM_ATTR, 12, 4)
    FIELD(SMMU_S2CR0, MTCFG, 11, 1)
    FIELD(SMMU_S2CR0, SHCFG, 8, 2)
    FIELD(SMMU_S2CR0, CBNDX_VMID, 0, 8)
REG32(SMMU_PIDR4, 0xfd0)
    FIELD(SMMU_PIDR4, FOURKB_COUNT, 4, 4)
    FIELD(SMMU_PIDR4, JEP106_CONTINUATION_CODE, 0, 4)
REG32(SMMU_PIDR5, 0xfd4)
REG32(SMMU_PIDR6, 0xfd8)
REG32(SMMU_PIDR7, 0xfdc)
REG32(SMMU_PIDR0, 0xfe0)
    FIELD(SMMU_PIDR0, PARTNUMBER0, 0, 8)
REG32(SMMU_PIDR1, 0xfe4)
    FIELD(SMMU_PIDR1, JEP106_IDENTITY_CODE, 4, 4)
    FIELD(SMMU_PIDR1, PARTNUMBER1, 0, 4)
REG32(SMMU_PIDR2, 0xfe8)
    FIELD(SMMU_PIDR2, ARCHITECTURE_REVISION, 4, 4)
    FIELD(SMMU_PIDR2, JEDEC, 3, 1)
    FIELD(SMMU_PIDR2, JEP106_IDENTITY_CODE, 0, 3)
REG32(SMMU_PIDR3, 0xfec)
    FIELD(SMMU_PIDR3, REVAND, 4, 4)
    FIELD(SMMU_PIDR3, CUSTOMER_MODIFIED, 0, 4)
REG32(SMMU_CIDR0, 0xff0)
    FIELD(SMMU_CIDR0, PREAMBLE, 0, 8)
REG32(SMMU_CIDR1, 0xff4)
    FIELD(SMMU_CIDR1, PREAMBLE, 0, 8)
REG32(SMMU_CIDR2, 0xff8)
    FIELD(SMMU_CIDR2, PREAMBLE, 0, 8)
REG32(SMMU_CIDR3, 0xffc)
    FIELD(SMMU_CIDR3, PREAMBLE, 0, 8)
REG32(SMMU_CBAR0, 0x1000)
    FIELD(SMMU_CBAR0, IRPTNDX, 24, 8)
    FIELD(SMMU_CBAR0, WACFG, 22, 2)
    FIELD(SMMU_CBAR0, RACFG, 20, 2)
    FIELD(SMMU_CBAR0, BSU, 18, 2)
    FIELD(SMMU_CBAR0, TYPE, 16, 2)
    FIELD(SMMU_CBAR0, MEMATTR_CBNDX_7_4, 12, 4)
    FIELD(SMMU_CBAR0, FB_CBNDX_3, 11, 1)
    FIELD(SMMU_CBAR0, HYPC_CBNDX_2, 10, 1)
    FIELD(SMMU_CBAR0, BPSHCFG_CBNDX_1_0, 8, 2)
    FIELD(SMMU_CBAR0, VMID, 0, 8)
REG32(SMMU_CBFRSYNRA0, 0x1400)
    FIELD(SMMU_CBFRSYNRA0, SSD_INDEX, 16, 15)
    FIELD(SMMU_CBFRSYNRA0, STREAMID, 0, 15)
REG32(SMMU_CBA2R0, 0x1800)
    FIELD(SMMU_CBA2R0, MONC, 1, 1)
    FIELD(SMMU_CBA2R0, VA64, 0, 1)
REG32(SMMU_ITCTRL, 0x2000)
    FIELD(SMMU_ITCTRL, TBU_INDEX, 4, 3)
    FIELD(SMMU_ITCTRL, MODULE, 3, 1)
    FIELD(SMMU_ITCTRL, RAM_DATA, 2, 1)
    FIELD(SMMU_ITCTRL, RAM_MODE, 1, 1)
    FIELD(SMMU_ITCTRL, INTGMODE, 0, 1)
REG32(SMMU_ITIP, 0x2004)
    FIELD(SMMU_ITIP, SPINDEN, 0, 1)
REG32(SMMU_ITOP_GLBL, 0x2008)
    FIELD(SMMU_ITOP_GLBL, TCU_RAM_DATA, 16, 4)
    FIELD(SMMU_ITOP_GLBL, GLBLSF1, 9, 1)
    FIELD(SMMU_ITOP_GLBL, GLBLNSF1, 1, 1)
REG32(SMMU_ITOP_PERF_INDEX, 0x200c)
    FIELD(SMMU_ITOP_PERF_INDEX, WAY_IPA2PA_PF, 30, 2)
    FIELD(SMMU_ITOP_PERF_INDEX, IPA2PA_PF_INDEX, 16, 7)
    FIELD(SMMU_ITOP_PERF_INDEX, WAY_MTLB_WC, 14, 2)
    FIELD(SMMU_ITOP_PERF_INDEX, MTLB_WC_INDEX, 0, 12)
REG32(SMMU_ITOP_CXT0TO31_RAM0, 0x2010)
REG32(SMMU_TBUQOS0, 0x2100)
    FIELD(SMMU_TBUQOS0, QOSTBU5, 20, 4)
    FIELD(SMMU_TBUQOS0, QOSTBU4, 16, 4)
    FIELD(SMMU_TBUQOS0, QOSTBU3, 12, 4)
    FIELD(SMMU_TBUQOS0, QOSTBU2, 8, 4)
    FIELD(SMMU_TBUQOS0, QOSTBU1, 4, 4)
    FIELD(SMMU_TBUQOS0, QOSTBU0, 0, 4)
REG32(SMMU_PER, 0x2200)
    FIELD(SMMU_PER, PER_TCU, 8, 8)
    FIELD(SMMU_PER, PER_TBU, 0, 8)
REG32(SMMU_TBU_PWR_STATUS, 0x2204)
REG32(PMEVCNTR0, 0x3000)
REG32(PMEVCNTR1, 0x3004)
REG32(PMEVCNTR2, 0x3008)
REG32(PMEVCNTR3, 0x300c)
REG32(PMEVCNTR4, 0x3010)
REG32(PMEVCNTR5, 0x3014)
REG32(PMEVCNTR6, 0x3018)
REG32(PMEVCNTR7, 0x301c)
REG32(PMEVCNTR8, 0x3020)
REG32(PMEVCNTR9, 0x3024)
REG32(PMEVCNTR10, 0x3028)
REG32(PMEVCNTR11, 0x302c)
REG32(PMEVCNTR12, 0x3030)
REG32(PMEVCNTR13, 0x3034)
REG32(PMEVCNTR14, 0x3038)
REG32(PMEVCNTR15, 0x303c)
REG32(PMEVCNTR16, 0x3040)
REG32(PMEVCNTR17, 0x3044)
REG32(PMEVCNTR18, 0x3048)
REG32(PMEVCNTR19, 0x304c)
REG32(PMEVCNTR20, 0x3050)
REG32(PMEVCNTR21, 0x3054)
REG32(PMEVCNTR22, 0x3058)
REG32(PMEVCNTR23, 0x305c)
REG32(PMEVTYPER0, 0x3400)
    FIELD(PMEVTYPER0, P, 31, 1)
    FIELD(PMEVTYPER0, U, 30, 1)
    FIELD(PMEVTYPER0, NSP, 29, 1)
    FIELD(PMEVTYPER0, NSU, 28, 1)
    FIELD(PMEVTYPER0, EVENT, 0, 5)
REG32(PMEVTYPER1, 0x3404)
    FIELD(PMEVTYPER1, P, 31, 1)
    FIELD(PMEVTYPER1, U, 30, 1)
    FIELD(PMEVTYPER1, NSP, 29, 1)
    FIELD(PMEVTYPER1, NSU, 28, 1)
    FIELD(PMEVTYPER1, EVENT, 0, 5)
REG32(PMEVTYPER2, 0x3408)
    FIELD(PMEVTYPER2, P, 31, 1)
    FIELD(PMEVTYPER2, U, 30, 1)
    FIELD(PMEVTYPER2, NSP, 29, 1)
    FIELD(PMEVTYPER2, NSU, 28, 1)
    FIELD(PMEVTYPER2, EVENT, 0, 5)
REG32(PMEVTYPER3, 0x340c)
    FIELD(PMEVTYPER3, P, 31, 1)
    FIELD(PMEVTYPER3, U, 30, 1)
    FIELD(PMEVTYPER3, NSP, 29, 1)
    FIELD(PMEVTYPER3, NSU, 28, 1)
    FIELD(PMEVTYPER3, EVENT, 0, 5)
REG32(PMEVTYPER4, 0x3410)
    FIELD(PMEVTYPER4, P, 31, 1)
    FIELD(PMEVTYPER4, U, 30, 1)
    FIELD(PMEVTYPER4, NSP, 29, 1)
    FIELD(PMEVTYPER4, NSU, 28, 1)
    FIELD(PMEVTYPER4, EVENT, 0, 5)
REG32(PMEVTYPER5, 0x3414)
    FIELD(PMEVTYPER5, P, 31, 1)
    FIELD(PMEVTYPER5, U, 30, 1)
    FIELD(PMEVTYPER5, NSP, 29, 1)
    FIELD(PMEVTYPER5, NSU, 28, 1)
    FIELD(PMEVTYPER5, EVENT, 0, 5)
REG32(PMEVTYPER6, 0x3418)
    FIELD(PMEVTYPER6, P, 31, 1)
    FIELD(PMEVTYPER6, U, 30, 1)
    FIELD(PMEVTYPER6, NSP, 29, 1)
    FIELD(PMEVTYPER6, NSU, 28, 1)
    FIELD(PMEVTYPER6, EVENT, 0, 5)
REG32(PMEVTYPER7, 0x341c)
    FIELD(PMEVTYPER7, P, 31, 1)
    FIELD(PMEVTYPER7, U, 30, 1)
    FIELD(PMEVTYPER7, NSP, 29, 1)
    FIELD(PMEVTYPER7, NSU, 28, 1)
    FIELD(PMEVTYPER7, EVENT, 0, 5)
REG32(PMEVTYPER8, 0x3420)
    FIELD(PMEVTYPER8, P, 31, 1)
    FIELD(PMEVTYPER8, U, 30, 1)
    FIELD(PMEVTYPER8, NSP, 29, 1)
    FIELD(PMEVTYPER8, NSU, 28, 1)
    FIELD(PMEVTYPER8, EVENT, 0, 5)
REG32(PMEVTYPER9, 0x3424)
    FIELD(PMEVTYPER9, P, 31, 1)
    FIELD(PMEVTYPER9, U, 30, 1)
    FIELD(PMEVTYPER9, NSP, 29, 1)
    FIELD(PMEVTYPER9, NSU, 28, 1)
    FIELD(PMEVTYPER9, EVENT, 0, 5)
REG32(PMEVTYPER10, 0x3428)
    FIELD(PMEVTYPER10, P, 31, 1)
    FIELD(PMEVTYPER10, U, 30, 1)
    FIELD(PMEVTYPER10, NSP, 29, 1)
    FIELD(PMEVTYPER10, NSU, 28, 1)
    FIELD(PMEVTYPER10, EVENT, 0, 5)
REG32(PMEVTYPER11, 0x342c)
    FIELD(PMEVTYPER11, P, 31, 1)
    FIELD(PMEVTYPER11, U, 30, 1)
    FIELD(PMEVTYPER11, NSP, 29, 1)
    FIELD(PMEVTYPER11, NSU, 28, 1)
    FIELD(PMEVTYPER11, EVENT, 0, 5)
REG32(PMEVTYPER12, 0x3430)
    FIELD(PMEVTYPER12, P, 31, 1)
    FIELD(PMEVTYPER12, U, 30, 1)
    FIELD(PMEVTYPER12, NSP, 29, 1)
    FIELD(PMEVTYPER12, NSU, 28, 1)
    FIELD(PMEVTYPER12, EVENT, 0, 5)
REG32(PMEVTYPER13, 0x3434)
    FIELD(PMEVTYPER13, P, 31, 1)
    FIELD(PMEVTYPER13, U, 30, 1)
    FIELD(PMEVTYPER13, NSP, 29, 1)
    FIELD(PMEVTYPER13, NSU, 28, 1)
    FIELD(PMEVTYPER13, EVENT, 0, 5)
REG32(PMEVTYPER14, 0x3438)
    FIELD(PMEVTYPER14, P, 31, 1)
    FIELD(PMEVTYPER14, U, 30, 1)
    FIELD(PMEVTYPER14, NSP, 29, 1)
    FIELD(PMEVTYPER14, NSU, 28, 1)
    FIELD(PMEVTYPER14, EVENT, 0, 5)
REG32(PMEVTYPER15, 0x343c)
    FIELD(PMEVTYPER15, P, 31, 1)
    FIELD(PMEVTYPER15, U, 30, 1)
    FIELD(PMEVTYPER15, NSP, 29, 1)
    FIELD(PMEVTYPER15, NSU, 28, 1)
    FIELD(PMEVTYPER15, EVENT, 0, 5)
REG32(PMEVTYPER16, 0x3440)
    FIELD(PMEVTYPER16, P, 31, 1)
    FIELD(PMEVTYPER16, U, 30, 1)
    FIELD(PMEVTYPER16, NSP, 29, 1)
    FIELD(PMEVTYPER16, NSU, 28, 1)
    FIELD(PMEVTYPER16, EVENT, 0, 5)
REG32(PMEVTYPER17, 0x3444)
    FIELD(PMEVTYPER17, P, 31, 1)
    FIELD(PMEVTYPER17, U, 30, 1)
    FIELD(PMEVTYPER17, NSP, 29, 1)
    FIELD(PMEVTYPER17, NSU, 28, 1)
    FIELD(PMEVTYPER17, EVENT, 0, 5)
REG32(PMEVTYPER18, 0x3448)
    FIELD(PMEVTYPER18, P, 31, 1)
    FIELD(PMEVTYPER18, U, 30, 1)
    FIELD(PMEVTYPER18, NSP, 29, 1)
    FIELD(PMEVTYPER18, NSU, 28, 1)
    FIELD(PMEVTYPER18, EVENT, 0, 5)
REG32(PMEVTYPER19, 0x344c)
    FIELD(PMEVTYPER19, P, 31, 1)
    FIELD(PMEVTYPER19, U, 30, 1)
    FIELD(PMEVTYPER19, NSP, 29, 1)
    FIELD(PMEVTYPER19, NSU, 28, 1)
    FIELD(PMEVTYPER19, EVENT, 0, 5)
REG32(PMEVTYPER20, 0x3450)
    FIELD(PMEVTYPER20, P, 31, 1)
    FIELD(PMEVTYPER20, U, 30, 1)
    FIELD(PMEVTYPER20, NSP, 29, 1)
    FIELD(PMEVTYPER20, NSU, 28, 1)
    FIELD(PMEVTYPER20, EVENT, 0, 5)
REG32(PMEVTYPER21, 0x3454)
    FIELD(PMEVTYPER21, P, 31, 1)
    FIELD(PMEVTYPER21, U, 30, 1)
    FIELD(PMEVTYPER21, NSP, 29, 1)
    FIELD(PMEVTYPER21, NSU, 28, 1)
    FIELD(PMEVTYPER21, EVENT, 0, 5)
REG32(PMEVTYPER22, 0x3458)
    FIELD(PMEVTYPER22, P, 31, 1)
    FIELD(PMEVTYPER22, U, 30, 1)
    FIELD(PMEVTYPER22, NSP, 29, 1)
    FIELD(PMEVTYPER22, NSU, 28, 1)
    FIELD(PMEVTYPER22, EVENT, 0, 5)
REG32(PMEVTYPER23, 0x345c)
    FIELD(PMEVTYPER23, P, 31, 1)
    FIELD(PMEVTYPER23, U, 30, 1)
    FIELD(PMEVTYPER23, NSP, 29, 1)
    FIELD(PMEVTYPER23, NSU, 28, 1)
    FIELD(PMEVTYPER23, EVENT, 0, 5)
REG32(PMCGCR0, 0x3800)
    FIELD(PMCGCR0, CGNC, 24, 4)
    FIELD(PMCGCR0, SIDG, 16, 7)
    FIELD(PMCGCR0, X, 12, 1)
    FIELD(PMCGCR0, E, 11, 1)
    FIELD(PMCGCR0, CBAEN, 10, 1)
    FIELD(PMCGCR0, TCEFCFG, 8, 2)
    FIELD(PMCGCR0, NDX, 0, 4)
REG32(PMCGCR1, 0x3804)
    FIELD(PMCGCR1, CGNC, 24, 4)
    FIELD(PMCGCR1, SIDG, 16, 7)
    FIELD(PMCGCR1, X, 12, 1)
    FIELD(PMCGCR1, E, 11, 1)
    FIELD(PMCGCR1, CBAEN, 10, 1)
    FIELD(PMCGCR1, TCEFCFG, 8, 2)
    FIELD(PMCGCR1, NDX, 0, 4)
REG32(PMCGCR2, 0x3808)
    FIELD(PMCGCR2, CGNC, 24, 4)
    FIELD(PMCGCR2, SIDG, 16, 7)
    FIELD(PMCGCR2, X, 12, 1)
    FIELD(PMCGCR2, E, 11, 1)
    FIELD(PMCGCR2, CBAEN, 10, 1)
    FIELD(PMCGCR2, TCEFCFG, 8, 2)
    FIELD(PMCGCR2, NDX, 0, 4)
REG32(PMCGCR3, 0x380c)
    FIELD(PMCGCR3, CGNC, 24, 4)
    FIELD(PMCGCR3, SIDG, 16, 7)
    FIELD(PMCGCR3, X, 12, 1)
    FIELD(PMCGCR3, E, 11, 1)
    FIELD(PMCGCR3, CBAEN, 10, 1)
    FIELD(PMCGCR3, TCEFCFG, 8, 2)
    FIELD(PMCGCR3, NDX, 0, 4)
REG32(PMCGCR4, 0x3810)
    FIELD(PMCGCR4, CGNC, 24, 4)
    FIELD(PMCGCR4, SIDG, 16, 7)
    FIELD(PMCGCR4, X, 12, 1)
    FIELD(PMCGCR4, E, 11, 1)
    FIELD(PMCGCR4, CBAEN, 10, 1)
    FIELD(PMCGCR4, TCEFCFG, 8, 2)
    FIELD(PMCGCR4, NDX, 0, 4)
REG32(PMCGCR5, 0x3814)
    FIELD(PMCGCR5, CGNC, 24, 4)
    FIELD(PMCGCR5, SIDG, 16, 7)
    FIELD(PMCGCR5, X, 12, 1)
    FIELD(PMCGCR5, E, 11, 1)
    FIELD(PMCGCR5, CBAEN, 10, 1)
    FIELD(PMCGCR5, TCEFCFG, 8, 2)
    FIELD(PMCGCR5, NDX, 0, 4)
REG32(PMCGSMR0, 0x3a00)
    FIELD(PMCGSMR0, MASK, 16, 10)
    FIELD(PMCGSMR0, ID, 0, 10)
REG32(PMCGSMR1, 0x3a04)
    FIELD(PMCGSMR1, MASK, 16, 10)
    FIELD(PMCGSMR1, ID, 0, 10)
REG32(PMCGSMR2, 0x3a08)
    FIELD(PMCGSMR2, MASK, 16, 10)
    FIELD(PMCGSMR2, ID, 0, 10)
REG32(PMCGSMR3, 0x3a0c)
    FIELD(PMCGSMR3, MASK, 16, 10)
    FIELD(PMCGSMR3, ID, 0, 10)
REG32(PMCGSMR4, 0x3a10)
    FIELD(PMCGSMR4, MASK, 16, 10)
    FIELD(PMCGSMR4, ID, 0, 10)
REG32(PMCGSMR5, 0x3a14)
    FIELD(PMCGSMR5, MASK, 16, 10)
    FIELD(PMCGSMR5, ID, 0, 10)
REG32(PMCNTENSET, 0x3c00)
    FIELD(PMCNTENSET, P23, 23, 1)
    FIELD(PMCNTENSET, P22, 22, 1)
    FIELD(PMCNTENSET, P21, 21, 1)
    FIELD(PMCNTENSET, P20, 20, 1)
    FIELD(PMCNTENSET, P19, 19, 1)
    FIELD(PMCNTENSET, P18, 18, 1)
    FIELD(PMCNTENSET, P17, 17, 1)
    FIELD(PMCNTENSET, P16, 16, 1)
    FIELD(PMCNTENSET, P15, 15, 1)
    FIELD(PMCNTENSET, P14, 14, 1)
    FIELD(PMCNTENSET, P13, 13, 1)
    FIELD(PMCNTENSET, P12, 12, 1)
    FIELD(PMCNTENSET, P11, 11, 1)
    FIELD(PMCNTENSET, P10, 10, 1)
    FIELD(PMCNTENSET, P9, 9, 1)
    FIELD(PMCNTENSET, P8, 8, 1)
    FIELD(PMCNTENSET, P7, 7, 1)
    FIELD(PMCNTENSET, P6, 6, 1)
    FIELD(PMCNTENSET, P5, 5, 1)
    FIELD(PMCNTENSET, P4, 4, 1)
    FIELD(PMCNTENSET, P3, 3, 1)
    FIELD(PMCNTENSET, P2, 2, 1)
    FIELD(PMCNTENSET, P1, 1, 1)
    FIELD(PMCNTENSET, P0, 0, 1)
REG32(PMCNTENCLR, 0x3c20)
    FIELD(PMCNTENCLR, P23, 23, 1)
    FIELD(PMCNTENCLR, P22, 22, 1)
    FIELD(PMCNTENCLR, P21, 21, 1)
    FIELD(PMCNTENCLR, P20, 20, 1)
    FIELD(PMCNTENCLR, P19, 19, 1)
    FIELD(PMCNTENCLR, P18, 18, 1)
    FIELD(PMCNTENCLR, P17, 17, 1)
    FIELD(PMCNTENCLR, P16, 16, 1)
    FIELD(PMCNTENCLR, P15, 15, 1)
    FIELD(PMCNTENCLR, P14, 14, 1)
    FIELD(PMCNTENCLR, P13, 13, 1)
    FIELD(PMCNTENCLR, P12, 12, 1)
    FIELD(PMCNTENCLR, P11, 11, 1)
    FIELD(PMCNTENCLR, P10, 10, 1)
    FIELD(PMCNTENCLR, P9, 9, 1)
    FIELD(PMCNTENCLR, P8, 8, 1)
    FIELD(PMCNTENCLR, P7, 7, 1)
    FIELD(PMCNTENCLR, P6, 6, 1)
    FIELD(PMCNTENCLR, P5, 5, 1)
    FIELD(PMCNTENCLR, P4, 4, 1)
    FIELD(PMCNTENCLR, P3, 3, 1)
    FIELD(PMCNTENCLR, P2, 2, 1)
    FIELD(PMCNTENCLR, P1, 1, 1)
    FIELD(PMCNTENCLR, P0, 0, 1)
REG32(PMINTENSET, 0x3c40)
    FIELD(PMINTENSET, P23, 23, 1)
    FIELD(PMINTENSET, P22, 22, 1)
    FIELD(PMINTENSET, P21, 21, 1)
    FIELD(PMINTENSET, P20, 20, 1)
    FIELD(PMINTENSET, P19, 19, 1)
    FIELD(PMINTENSET, P18, 18, 1)
    FIELD(PMINTENSET, P17, 17, 1)
    FIELD(PMINTENSET, P16, 16, 1)
    FIELD(PMINTENSET, P15, 15, 1)
    FIELD(PMINTENSET, P14, 14, 1)
    FIELD(PMINTENSET, P13, 13, 1)
    FIELD(PMINTENSET, P12, 12, 1)
    FIELD(PMINTENSET, P11, 11, 1)
    FIELD(PMINTENSET, P10, 10, 1)
    FIELD(PMINTENSET, P9, 9, 1)
    FIELD(PMINTENSET, P8, 8, 1)
    FIELD(PMINTENSET, P7, 7, 1)
    FIELD(PMINTENSET, P6, 6, 1)
    FIELD(PMINTENSET, P5, 5, 1)
    FIELD(PMINTENSET, P4, 4, 1)
    FIELD(PMINTENSET, P3, 3, 1)
    FIELD(PMINTENSET, P2, 2, 1)
    FIELD(PMINTENSET, P1, 1, 1)
    FIELD(PMINTENSET, P0, 0, 1)
REG32(PMINTENCLR, 0x3c60)
    FIELD(PMINTENCLR, P23, 23, 1)
    FIELD(PMINTENCLR, P22, 22, 1)
    FIELD(PMINTENCLR, P21, 21, 1)
    FIELD(PMINTENCLR, P20, 20, 1)
    FIELD(PMINTENCLR, P19, 19, 1)
    FIELD(PMINTENCLR, P18, 18, 1)
    FIELD(PMINTENCLR, P17, 17, 1)
    FIELD(PMINTENCLR, P16, 16, 1)
    FIELD(PMINTENCLR, P15, 15, 1)
    FIELD(PMINTENCLR, P14, 14, 1)
    FIELD(PMINTENCLR, P13, 13, 1)
    FIELD(PMINTENCLR, P12, 12, 1)
    FIELD(PMINTENCLR, P11, 11, 1)
    FIELD(PMINTENCLR, P10, 10, 1)
    FIELD(PMINTENCLR, P9, 9, 1)
    FIELD(PMINTENCLR, P8, 8, 1)
    FIELD(PMINTENCLR, P7, 7, 1)
    FIELD(PMINTENCLR, P6, 6, 1)
    FIELD(PMINTENCLR, P5, 5, 1)
    FIELD(PMINTENCLR, P4, 4, 1)
    FIELD(PMINTENCLR, P3, 3, 1)
    FIELD(PMINTENCLR, P2, 2, 1)
    FIELD(PMINTENCLR, P1, 1, 1)
    FIELD(PMINTENCLR, P0, 0, 1)
REG32(PMOVSCLR, 0x3c80)
    FIELD(PMOVSCLR, P23, 23, 1)
    FIELD(PMOVSCLR, P22, 22, 1)
    FIELD(PMOVSCLR, P21, 21, 1)
    FIELD(PMOVSCLR, P20, 20, 1)
    FIELD(PMOVSCLR, P19, 19, 1)
    FIELD(PMOVSCLR, P18, 18, 1)
    FIELD(PMOVSCLR, P17, 17, 1)
    FIELD(PMOVSCLR, P16, 16, 1)
    FIELD(PMOVSCLR, P15, 15, 1)
    FIELD(PMOVSCLR, P14, 14, 1)
    FIELD(PMOVSCLR, P13, 13, 1)
    FIELD(PMOVSCLR, P12, 12, 1)
    FIELD(PMOVSCLR, P11, 11, 1)
    FIELD(PMOVSCLR, P10, 10, 1)
    FIELD(PMOVSCLR, P9, 9, 1)
    FIELD(PMOVSCLR, P8, 8, 1)
    FIELD(PMOVSCLR, P7, 7, 1)
    FIELD(PMOVSCLR, P6, 6, 1)
    FIELD(PMOVSCLR, P5, 5, 1)
    FIELD(PMOVSCLR, P4, 4, 1)
    FIELD(PMOVSCLR, P3, 3, 1)
    FIELD(PMOVSCLR, P2, 2, 1)
    FIELD(PMOVSCLR, P1, 1, 1)
    FIELD(PMOVSCLR, P0, 0, 1)
REG32(PMOVSSET, 0x3cc0)
    FIELD(PMOVSSET, P23, 23, 1)
    FIELD(PMOVSSET, P22, 22, 1)
    FIELD(PMOVSSET, P21, 21, 1)
    FIELD(PMOVSSET, P20, 20, 1)
    FIELD(PMOVSSET, P19, 19, 1)
    FIELD(PMOVSSET, P18, 18, 1)
    FIELD(PMOVSSET, P17, 17, 1)
    FIELD(PMOVSSET, P16, 16, 1)
    FIELD(PMOVSSET, P15, 15, 1)
    FIELD(PMOVSSET, P14, 14, 1)
    FIELD(PMOVSSET, P13, 13, 1)
    FIELD(PMOVSSET, P12, 12, 1)
    FIELD(PMOVSSET, P11, 11, 1)
    FIELD(PMOVSSET, P10, 10, 1)
    FIELD(PMOVSSET, P9, 9, 1)
    FIELD(PMOVSSET, P8, 8, 1)
    FIELD(PMOVSSET, P7, 7, 1)
    FIELD(PMOVSSET, P6, 6, 1)
    FIELD(PMOVSSET, P5, 5, 1)
    FIELD(PMOVSSET, P4, 4, 1)
    FIELD(PMOVSSET, P3, 3, 1)
    FIELD(PMOVSSET, P2, 2, 1)
    FIELD(PMOVSSET, P1, 1, 1)
    FIELD(PMOVSSET, P0, 0, 1)
REG32(PMCFGR, 0x3e00)
    FIELD(PMCFGR, NCG, 24, 8)
    FIELD(PMCFGR, UEN, 19, 1)
    FIELD(PMCFGR, EX, 16, 1)
    FIELD(PMCFGR, CCD, 15, 1)
    FIELD(PMCFGR, CC, 14, 1)
    FIELD(PMCFGR, SIZE, 8, 6)
    FIELD(PMCFGR, N, 0, 8)
REG32(PMCR, 0x3e04)
    FIELD(PMCR, IMP, 24, 8)
    FIELD(PMCR, X, 4, 1)
    FIELD(PMCR, P, 1, 1)
    FIELD(PMCR, E, 0, 1)
REG32(PMCEID0, 0x3e20)
    FIELD(PMCEID0, EVENT0X12, 17, 1)
    FIELD(PMCEID0, EVENT0X11, 16, 1)
    FIELD(PMCEID0, EVENT0X10, 15, 1)
    FIELD(PMCEID0, EVENT0X0A, 9, 1)
    FIELD(PMCEID0, EVENT0X09, 8, 1)
    FIELD(PMCEID0, EVENT0X08, 7, 1)
    FIELD(PMCEID0, EVENT0X01, 1, 1)
    FIELD(PMCEID0, EVENT0X00, 0, 1)
REG32(PMAUTHSTATUS, 0x3fb8)
    FIELD(PMAUTHSTATUS, SNI, 7, 1)
    FIELD(PMAUTHSTATUS, SNE, 6, 1)
    FIELD(PMAUTHSTATUS, SI, 5, 1)
    FIELD(PMAUTHSTATUS, SE, 4, 1)
    FIELD(PMAUTHSTATUS, NSNI, 3, 1)
    FIELD(PMAUTHSTATUS, NSNE, 2, 1)
    FIELD(PMAUTHSTATUS, NSI, 1, 1)
    FIELD(PMAUTHSTATUS, NSE, 0, 1)
REG32(PMDEVTYPE, 0x3fcc)
    FIELD(PMDEVTYPE, T, 4, 4)
    FIELD(PMDEVTYPE, C, 0, 4)

/* The following CB regs are based off zero.  */
REG32(SMMU_CB0_SCTLR, 0x0)
    FIELD(SMMU_CB0_SCTLR, NSCFG, 28, 2)
    FIELD(SMMU_CB0_SCTLR, WACFG, 26, 2)
    FIELD(SMMU_CB0_SCTLR, RACFG, 24, 2)
    FIELD(SMMU_CB0_SCTLR, SHCFG, 22, 2)
    FIELD(SMMU_CB0_SCTLR, FB, 21, 1)
    FIELD(SMMU_CB0_SCTLR, MTCFG, 20, 1)
    FIELD(SMMU_CB0_SCTLR, MEMATTR, 16, 4)
    FIELD(SMMU_CB0_SCTLR, TRANSIENTCFG, 14, 2)
    FIELD(SMMU_CB0_SCTLR, PTW, 13, 1)
    FIELD(SMMU_CB0_SCTLR, ASIDPNE, 12, 1)
    FIELD(SMMU_CB0_SCTLR, UWXN, 10, 1)
    FIELD(SMMU_CB0_SCTLR, WXN, 9, 1)
    FIELD(SMMU_CB0_SCTLR, HUPCF, 8, 1)
    FIELD(SMMU_CB0_SCTLR, CFCFG, 7, 1)
    FIELD(SMMU_CB0_SCTLR, CFIE, 6, 1)
    FIELD(SMMU_CB0_SCTLR, CFRE, 5, 1)
    FIELD(SMMU_CB0_SCTLR, E, 4, 1)
    FIELD(SMMU_CB0_SCTLR, AFFD, 3, 1)
    FIELD(SMMU_CB0_SCTLR, AFE, 2, 1)
    FIELD(SMMU_CB0_SCTLR, TRE, 1, 1)
    FIELD(SMMU_CB0_SCTLR, M, 0, 1)
REG32(SMMU_CB0_ACTLR, 0x4)
    FIELD(SMMU_CB0_ACTLR, CPRE, 1, 1)
    FIELD(SMMU_CB0_ACTLR, CMTLB, 0, 1)
REG32(SMMU_CB0_RESUME, 0x8)
    FIELD(SMMU_CB0_RESUME, TNR, 0, 1)
REG32(SMMU_CB0_TCR2, 0x10)
    FIELD(SMMU_CB0_TCR2, NSCFG1, 30, 1)
    FIELD(SMMU_CB0_TCR2, SEP, 15, 3)
    FIELD(SMMU_CB0_TCR2, NSCFG0, 14, 1)
    FIELD(SMMU_CB0_TCR2, HD, 11, 1)
    FIELD(SMMU_CB0_TCR2, HA, 10, 1)
    FIELD(SMMU_CB0_TCR2, TBI1, 6, 1)
    FIELD(SMMU_CB0_TCR2, TBI0, 5, 1)
    FIELD(SMMU_CB0_TCR2, AS, 4, 1)
    FIELD(SMMU_CB0_TCR2, PASIZE, 0, 3)
REG32(SMMU_CB0_TTBR0_LOW, 0x20)
    FIELD(SMMU_CB0_TTBR0_LOW, ADDRESS_31_7, 7, 25)
    FIELD(SMMU_CB0_TTBR0_LOW, ADDRESS_6_IRGN0, 6, 1)
    FIELD(SMMU_CB0_TTBR0_LOW, ADDRESS_5_NOS, 5, 1)
    FIELD(SMMU_CB0_TTBR0_LOW, ADDRESS_4_3_RGN, 3, 2)
    FIELD(SMMU_CB0_TTBR0_LOW, ADDRESS_2, 2, 1)
    FIELD(SMMU_CB0_TTBR0_LOW, ADDRESS_1_S, 1, 1)
    FIELD(SMMU_CB0_TTBR0_LOW, ADDRESS_0_IRGN1, 0, 1)
REG32(SMMU_CB0_TTBR0_HIGH, 0x24)
    FIELD(SMMU_CB0_TTBR0_HIGH, ASID, 16, 16)
    FIELD(SMMU_CB0_TTBR0_HIGH, ADDRESS, 0, 16)
REG32(SMMU_CB0_TTBR1_LOW, 0x28)
    FIELD(SMMU_CB0_TTBR1_LOW, ADDRESS_31_7, 7, 25)
    FIELD(SMMU_CB0_TTBR1_LOW, ADDRESS_6_IRGN0, 6, 1)
    FIELD(SMMU_CB0_TTBR1_LOW, ADDRESS_5_NOS, 5, 1)
    FIELD(SMMU_CB0_TTBR1_LOW, ADDRESS_4_3_RGN, 3, 2)
    FIELD(SMMU_CB0_TTBR1_LOW, ADDRESS_2, 2, 1)
    FIELD(SMMU_CB0_TTBR1_LOW, ADDRESS_1_S, 1, 1)
    FIELD(SMMU_CB0_TTBR1_LOW, ADDRESS_0_IRGN1, 0, 1)
REG32(SMMU_CB0_TTBR1_HIGH, 0x2c)
    FIELD(SMMU_CB0_TTBR1_HIGH, ASID, 16, 16)
    FIELD(SMMU_CB0_TTBR1_HIGH, ADDRESS, 0, 16)
REG32(SMMU_CB0_TCR_LPAE, 0x30)
    FIELD(SMMU_CB0_TCR_LPAE, EAE, 31, 1)
    FIELD(SMMU_CB0_TCR_LPAE, NSCFG1_TG1, 30, 1)
    FIELD(SMMU_CB0_TCR_LPAE, SH1, 28, 2)
    FIELD(SMMU_CB0_TCR_LPAE, ORGN1, 26, 2)
    FIELD(SMMU_CB0_TCR_LPAE, IRGN1, 24, 2)
    FIELD(SMMU_CB0_TCR_LPAE, EPD1, 23, 1)
    FIELD(SMMU_CB0_TCR_LPAE, A1, 22, 1)
    FIELD(SMMU_CB0_TCR_LPAE, T1SZ_5_3, 19, 3)
    FIELD(SMMU_CB0_TCR_LPAE, T1SZ_2_0_PASIZE, 16, 3)
    FIELD(SMMU_CB0_TCR_LPAE, NSCFG0_TG0, 14, 1)
    FIELD(SMMU_CB0_TCR_LPAE, SH0, 12, 2)
    FIELD(SMMU_CB0_TCR_LPAE, ORGN0, 10, 2)
    FIELD(SMMU_CB0_TCR_LPAE, IRGN0, 8, 2)
    FIELD(SMMU_CB0_TCR_LPAE, SL0_1_EPD0, 7, 1)
    FIELD(SMMU_CB0_TCR_LPAE, SL0_0, 6, 1)
    FIELD(SMMU_CB0_TCR_LPAE, PD1_T0SZ_5, 5, 1)
    FIELD(SMMU_CB0_TCR_LPAE, S_PD0_T0SZ_4, 4, 1)
    FIELD(SMMU_CB0_TCR_LPAE, T0SZ_3_0, 0, 4)
REG32(SMMU_CB0_CONTEXTIDR, 0x34)
    FIELD(SMMU_CB0_CONTEXTIDR, PROCID, 8, 24)
    FIELD(SMMU_CB0_CONTEXTIDR, ASID, 0, 8)
REG32(SMMU_CB0_PRRR_MAIR0, 0x38)
    FIELD(SMMU_CB0_PRRR_MAIR0, NOS7, 31, 1)
    FIELD(SMMU_CB0_PRRR_MAIR0, NOS6, 30, 1)
    FIELD(SMMU_CB0_PRRR_MAIR0, NOS5, 29, 1)
    FIELD(SMMU_CB0_PRRR_MAIR0, NOS4, 28, 1)
    FIELD(SMMU_CB0_PRRR_MAIR0, NOS3, 27, 1)
    FIELD(SMMU_CB0_PRRR_MAIR0, NOS2, 26, 1)
    FIELD(SMMU_CB0_PRRR_MAIR0, NOS1, 25, 1)
    FIELD(SMMU_CB0_PRRR_MAIR0, NOS0, 24, 1)
    FIELD(SMMU_CB0_PRRR_MAIR0, NS1, 19, 1)
    FIELD(SMMU_CB0_PRRR_MAIR0, NS0, 18, 1)
    FIELD(SMMU_CB0_PRRR_MAIR0, DS1, 17, 1)
    FIELD(SMMU_CB0_PRRR_MAIR0, DS0, 16, 1)
    FIELD(SMMU_CB0_PRRR_MAIR0, TR7, 14, 2)
    FIELD(SMMU_CB0_PRRR_MAIR0, TR6, 12, 2)
    FIELD(SMMU_CB0_PRRR_MAIR0, TR5, 10, 2)
    FIELD(SMMU_CB0_PRRR_MAIR0, TR4, 8, 2)
    FIELD(SMMU_CB0_PRRR_MAIR0, TR3, 6, 2)
    FIELD(SMMU_CB0_PRRR_MAIR0, TR2, 4, 2)
    FIELD(SMMU_CB0_PRRR_MAIR0, TR1, 2, 2)
    FIELD(SMMU_CB0_PRRR_MAIR0, TR0, 0, 2)
REG32(SMMU_CB0_NMRR_MAIR1, 0x3c)
    FIELD(SMMU_CB0_NMRR_MAIR1, OR7, 30, 2)
    FIELD(SMMU_CB0_NMRR_MAIR1, OR6, 28, 2)
    FIELD(SMMU_CB0_NMRR_MAIR1, OR5, 26, 2)
    FIELD(SMMU_CB0_NMRR_MAIR1, OR4, 24, 2)
    FIELD(SMMU_CB0_NMRR_MAIR1, OR3, 22, 2)
    FIELD(SMMU_CB0_NMRR_MAIR1, OR2, 20, 2)
    FIELD(SMMU_CB0_NMRR_MAIR1, OR1, 18, 2)
    FIELD(SMMU_CB0_NMRR_MAIR1, OR0, 16, 2)
    FIELD(SMMU_CB0_NMRR_MAIR1, IR7, 14, 2)
    FIELD(SMMU_CB0_NMRR_MAIR1, IR6, 12, 2)
    FIELD(SMMU_CB0_NMRR_MAIR1, IR5, 10, 2)
    FIELD(SMMU_CB0_NMRR_MAIR1, IR4, 8, 2)
    FIELD(SMMU_CB0_NMRR_MAIR1, IR3, 6, 2)
    FIELD(SMMU_CB0_NMRR_MAIR1, IR2, 4, 2)
    FIELD(SMMU_CB0_NMRR_MAIR1, IR1, 2, 2)
    FIELD(SMMU_CB0_NMRR_MAIR1, IR0, 0, 2)
REG32(SMMU_CB0_FSR, 0x58)
    FIELD(SMMU_CB0_FSR, MULTI, 31, 1)
    FIELD(SMMU_CB0_FSR, SS, 30, 1)
    FIELD(SMMU_CB0_FSR, FORMAT, 9, 2)
    FIELD(SMMU_CB0_FSR, UUT, 8, 1)
    FIELD(SMMU_CB0_FSR, ASF, 7, 1)
    FIELD(SMMU_CB0_FSR, TLBLKF, 6, 1)
    FIELD(SMMU_CB0_FSR, TLBMCF, 5, 1)
    FIELD(SMMU_CB0_FSR, EF, 4, 1)
    FIELD(SMMU_CB0_FSR, PF, 3, 1)
    FIELD(SMMU_CB0_FSR, AFF, 2, 1)
    FIELD(SMMU_CB0_FSR, TF, 1, 1)
REG32(SMMU_CB0_FSRRESTORE, 0x5c)
REG32(SMMU_CB0_FAR_LOW, 0x60)
REG32(SMMU_CB0_FAR_HIGH, 0x64)
    FIELD(SMMU_CB0_FAR_HIGH, BITS, 0, 17)
REG32(SMMU_CB0_FSYNR0, 0x68)
    FIELD(SMMU_CB0_FSYNR0, S1CBNDX, 16, 4)
    FIELD(SMMU_CB0_FSYNR0, AFR, 11, 1)
    FIELD(SMMU_CB0_FSYNR0, PTWF, 10, 1)
    FIELD(SMMU_CB0_FSYNR0, ATOF, 9, 1)
    FIELD(SMMU_CB0_FSYNR0, NSATTR, 8, 1)
    FIELD(SMMU_CB0_FSYNR0, IND, 6, 1)
    FIELD(SMMU_CB0_FSYNR0, PNU, 5, 1)
    FIELD(SMMU_CB0_FSYNR0, WNR, 4, 1)
    FIELD(SMMU_CB0_FSYNR0, PLVL, 0, 2)
REG32(SMMU_CB0_IPAFAR_LOW, 0x70)
    FIELD(SMMU_CB0_IPAFAR_LOW, IPAFAR_L, 12, 20)
    FIELD(SMMU_CB0_IPAFAR_LOW, FAR_RO, 0, 12)
REG32(SMMU_CB0_IPAFAR_HIGH, 0x74)
    FIELD(SMMU_CB0_IPAFAR_HIGH, BITS, 0, 16)
REG32(SMMU_CB0_TLBIVA_LOW, 0x600)
REG32(SMMU_CB0_TLBIVA_HIGH, 0x604)
    FIELD(SMMU_CB0_TLBIVA_HIGH, ASID, 16, 16)
    FIELD(SMMU_CB0_TLBIVA_HIGH, ADDRESS, 0, 5)
REG32(SMMU_CB0_TLBIVAA_LOW, 0x608)
REG32(SMMU_CB0_TLBIVAA_HIGH, 0x60c)
    FIELD(SMMU_CB0_TLBIVAA_HIGH, ASID, 16, 16)
    FIELD(SMMU_CB0_TLBIVAA_HIGH, ADDRESS, 0, 5)
REG32(SMMU_CB0_TLBIASID, 0x610)
    FIELD(SMMU_CB0_TLBIASID, ASID, 0, 16)
REG32(SMMU_CB0_TLBIALL, 0x618)
REG32(SMMU_CB0_TLBIVAL_LOW, 0x620)
REG32(SMMU_CB0_TLBIVAL_HIGH, 0x624)
    FIELD(SMMU_CB0_TLBIVAL_HIGH, ASID, 16, 16)
    FIELD(SMMU_CB0_TLBIVAL_HIGH, ADDRESS, 0, 5)
REG32(SMMU_CB0_TLBIVAAL_LOW, 0x628)
REG32(SMMU_CB0_TLBIVAAL_HIGH, 0x62c)
    FIELD(SMMU_CB0_TLBIVAAL_HIGH, ASID, 16, 16)
    FIELD(SMMU_CB0_TLBIVAAL_HIGH, ADDRESS, 0, 5)
REG32(SMMU_CB0_TLBIIPAS2_LOW, 0x630)
REG32(SMMU_CB0_TLBIIPAS2_HIGH, 0x634)
    FIELD(SMMU_CB0_TLBIIPAS2_HIGH, ADDRESS, 0, 4)
REG32(SMMU_CB0_TLBIIPAS2L_LOW, 0x638)
REG32(SMMU_CB0_TLBIIPAS2L_HIGH, 0x63c)
    FIELD(SMMU_CB0_TLBIIPAS2L_HIGH, ADDRESS, 0, 4)
REG32(SMMU_CB0_TLBSYNC, 0x7f0)
REG32(SMMU_CB0_TLBSTATUS, 0x7f4)
    FIELD(SMMU_CB0_TLBSTATUS, SACTIVE, 0, 1)
REG32(SMMU_CB0_PMEVCNTR0, 0xe00)
REG32(SMMU_CB0_PMEVCNTR1, 0xe04)
REG32(SMMU_CB0_PMEVCNTR2, 0xe08)
REG32(SMMU_CB0_PMEVCNTR3, 0xe0c)
REG32(SMMU_CB0_PMEVTYPER0, 0xe80)
    FIELD(SMMU_CB0_PMEVTYPER0, P, 31, 1)
    FIELD(SMMU_CB0_PMEVTYPER0, U, 30, 1)
    FIELD(SMMU_CB0_PMEVTYPER0, NSP, 29, 1)
    FIELD(SMMU_CB0_PMEVTYPER0, NSU, 28, 1)
    FIELD(SMMU_CB0_PMEVTYPER0, EVENT, 0, 5)
REG32(SMMU_CB0_PMEVTYPER1, 0xe84)
    FIELD(SMMU_CB0_PMEVTYPER1, P, 31, 1)
    FIELD(SMMU_CB0_PMEVTYPER1, U, 30, 1)
    FIELD(SMMU_CB0_PMEVTYPER1, NSP, 29, 1)
    FIELD(SMMU_CB0_PMEVTYPER1, NSU, 28, 1)
    FIELD(SMMU_CB0_PMEVTYPER1, EVENT, 0, 5)
REG32(SMMU_CB0_PMEVTYPER2, 0xe88)
    FIELD(SMMU_CB0_PMEVTYPER2, P, 31, 1)
    FIELD(SMMU_CB0_PMEVTYPER2, U, 30, 1)
    FIELD(SMMU_CB0_PMEVTYPER2, NSP, 29, 1)
    FIELD(SMMU_CB0_PMEVTYPER2, NSU, 28, 1)
    FIELD(SMMU_CB0_PMEVTYPER2, EVENT, 0, 5)
REG32(SMMU_CB0_PMEVTYPER3, 0xe8c)
    FIELD(SMMU_CB0_PMEVTYPER3, P, 31, 1)
    FIELD(SMMU_CB0_PMEVTYPER3, U, 30, 1)
    FIELD(SMMU_CB0_PMEVTYPER3, NSP, 29, 1)
    FIELD(SMMU_CB0_PMEVTYPER3, NSU, 28, 1)
    FIELD(SMMU_CB0_PMEVTYPER3, EVENT, 0, 5)
REG32(SMMU_CB0_PMCFGR, 0xf00)
    FIELD(SMMU_CB0_PMCFGR, NCG, 24, 8)
    FIELD(SMMU_CB0_PMCFGR, UEN, 19, 1)
    FIELD(SMMU_CB0_PMCFGR, EX, 16, 1)
    FIELD(SMMU_CB0_PMCFGR, CCD, 15, 1)
    FIELD(SMMU_CB0_PMCFGR, CC, 14, 1)
    FIELD(SMMU_CB0_PMCFGR, SIZE, 8, 6)
    FIELD(SMMU_CB0_PMCFGR, N, 0, 8)
REG32(SMMU_CB0_PMCR, 0xf04)
    FIELD(SMMU_CB0_PMCR, IMP, 24, 8)
    FIELD(SMMU_CB0_PMCR, X, 4, 1)
    FIELD(SMMU_CB0_PMCR, P, 1, 1)
    FIELD(SMMU_CB0_PMCR, E, 0, 1)
REG32(SMMU_CB0_PMCEID, 0xf20)
    FIELD(SMMU_CB0_PMCEID, EVENT0X12, 17, 1)
    FIELD(SMMU_CB0_PMCEID, EVENT0X11, 16, 1)
    FIELD(SMMU_CB0_PMCEID, EVENT0X10, 15, 1)
    FIELD(SMMU_CB0_PMCEID, EVENT0X0A, 9, 1)
    FIELD(SMMU_CB0_PMCEID, EVENT0X09, 8, 1)
    FIELD(SMMU_CB0_PMCEID, EVENT0X08, 7, 1)
    FIELD(SMMU_CB0_PMCEID, EVENT0X01, 1, 1)
    FIELD(SMMU_CB0_PMCEID, EVENT0X00, 0, 1)
REG32(SMMU_CB0_PMCNTENSE, 0xf40)
    FIELD(SMMU_CB0_PMCNTENSE, P3, 3, 1)
    FIELD(SMMU_CB0_PMCNTENSE, P2, 2, 1)
    FIELD(SMMU_CB0_PMCNTENSE, P1, 1, 1)
    FIELD(SMMU_CB0_PMCNTENSE, P0, 0, 1)
REG32(SMMU_CB0_PMCNTENCLR, 0xf44)
    FIELD(SMMU_CB0_PMCNTENCLR, P3, 3, 1)
    FIELD(SMMU_CB0_PMCNTENCLR, P2, 2, 1)
    FIELD(SMMU_CB0_PMCNTENCLR, P1, 1, 1)
    FIELD(SMMU_CB0_PMCNTENCLR, P0, 0, 1)
REG32(SMMU_CB0_PMCNTENSET, 0xf48)
    FIELD(SMMU_CB0_PMCNTENSET, P3, 3, 1)
    FIELD(SMMU_CB0_PMCNTENSET, P2, 2, 1)
    FIELD(SMMU_CB0_PMCNTENSET, P1, 1, 1)
    FIELD(SMMU_CB0_PMCNTENSET, P0, 0, 1)
REG32(SMMU_CB0_PMINTENCLR, 0xf4c)
    FIELD(SMMU_CB0_PMINTENCLR, P3, 3, 1)
    FIELD(SMMU_CB0_PMINTENCLR, P2, 2, 1)
    FIELD(SMMU_CB0_PMINTENCLR, P1, 1, 1)
    FIELD(SMMU_CB0_PMINTENCLR, P0, 0, 1)
REG32(SMMU_CB0_PMOVSCLR, 0xf50)
    FIELD(SMMU_CB0_PMOVSCLR, P3, 3, 1)
    FIELD(SMMU_CB0_PMOVSCLR, P2, 2, 1)
    FIELD(SMMU_CB0_PMOVSCLR, P1, 1, 1)
    FIELD(SMMU_CB0_PMOVSCLR, P0, 0, 1)
REG32(SMMU_CB0_PMOVSSET, 0xf58)
    FIELD(SMMU_CB0_PMOVSSET, P3, 3, 1)
    FIELD(SMMU_CB0_PMOVSSET, P2, 2, 1)
    FIELD(SMMU_CB0_PMOVSSET, P1, 1, 1)
    FIELD(SMMU_CB0_PMOVSSET, P0, 0, 1)
REG32(SMMU_CB0_PMAUTHSTATUS, 0xfb8)
    FIELD(SMMU_CB0_PMAUTHSTATUS, SNI, 7, 1)
    FIELD(SMMU_CB0_PMAUTHSTATUS, SNE, 6, 1)
    FIELD(SMMU_CB0_PMAUTHSTATUS, SI, 5, 1)
    FIELD(SMMU_CB0_PMAUTHSTATUS, SE, 4, 1)
    FIELD(SMMU_CB0_PMAUTHSTATUS, NSNI, 3, 1)
    FIELD(SMMU_CB0_PMAUTHSTATUS, NSNE, 2, 1)
    FIELD(SMMU_CB0_PMAUTHSTATUS, NSI, 1, 1)
    FIELD(SMMU_CB0_PMAUTHSTATUS, NSE, 0, 1)

/* Missing from the regspec.  */
REG32(SMMU_GATS1PR, 0x110)
    FIELD(SMMU_GATS1PR, NDX, 0, 7)
    FIELD(SMMU_GATS1PR, ADDR, 12, 52)
REG32(SMMU_GATS1PR_H, 0x114)
REG32(SMMU_GATS1PW, 0x118)
    FIELD(SMMU_GATS1PW, NDX, 0, 7)
    FIELD(SMMU_GATS1PW, ADDR, 12, 52)
REG32(SMMU_GATS1PW_H, 0x11C)
REG32(SMMU_GATS12PR, 0x130)
    FIELD(SMMU_GATS12PR, NDX, 0, 7)
    FIELD(SMMU_GATS12PR, ADDR, 12, 52)
REG32(SMMU_GATS12PR_H, 0x134)
REG32(SMMU_GATS12PW, 0x138)
    FIELD(SMMU_GATS12PW, NDX, 0, 7)
    FIELD(SMMU_GATS12PW, ADDR, 12, 52)
REG32(SMMU_GATS12PW_H, 0x13C)
REG32(SMMU_GPAR, 0x180)
REG32(SMMU_GPAR_H, 0x184)
REG32(SMMU_GATSR, 0x188)
    FIELD(SMMU_GATSR, ACTIVE, 0, 1)

typedef enum SMMUTranslationStatus {
    SMMU_TRANS_DISABLE,
    SMMU_TRANS_ABORT,
    SMMU_TRANS_BYPASS,
    SMMU_TRANS_ERROR,
    SMMU_TRANS_SUCCESS,
} SMMUv2TranslationStatus;

typedef enum SMMUv2FaultType {
    SMMU_FAULT_CTX_NONE               = 0x00,
    SMMU_FAULT_CTX_TRANS                    ,
    SMMU_FAULT_CTX_PERM                     ,
    SMMU_FAULT_CTX_EXT                      ,
    SMMU_FAULT_CTX_UNSUP_UPSTR_TRANS        ,
    SMMU_FAULT_GLOBAL_INVAL_CTX             ,
    SMMU_FAULT_GLOBAL_UDEF_SID              ,
    SMMU_FAULT_GLOBAL_SID_MATCH_CONFL       ,
    SMMU_FAULT_GLOBAL_UNIMPL_CTX_BANK       ,
    SMMU_FAULT_GLOBAL_UNIMPL_CTX_IRQ        ,
    SMMU_FAULT_GLOBAL_CFG_ACCESS            ,
    SMMU_FAULT_GLOBAL_PERM                  ,
    SMMU_FAULT_GLOBAL_EXT                   ,
    SMMU_FAULT_GLOBAL_UNSUP_UPSTR_TRANS     ,
    SMMU_FAULT_GLOBAL_ADDR_SIZE             ,
} SMMUv2FaultType;

static const char *event_stringify[] = {
    [SMMU_FAULT_CTX_NONE]                     = "no recorded event",
    [SMMU_FAULT_CTX_TRANS]                    = "SMMU_FAULT_CTX_TRANS",
    [SMMU_FAULT_CTX_PERM]                     = "SMMU_FAULT_CTX_PERM",
    [SMMU_FAULT_CTX_EXT]                      = "SMMU_FAULT_CTX_EXT",
    [SMMU_FAULT_CTX_UNSUP_UPSTR_TRANS]        = "SMMU_FAULT_CTX_UNSUP_UPSTR_TRANS",
    [SMMU_FAULT_GLOBAL_INVAL_CTX]             = "SMMU_FAULT_GLOBAL_INVAL_CTX",
    [SMMU_FAULT_GLOBAL_UDEF_SID]              = "SMMU_FAULT_GLOBAL_UDEF_SID",
    [SMMU_FAULT_GLOBAL_SID_MATCH_CONFL]       = "SMMU_FAULT_GLOBAL_SID_MATCH_CONFL",
    [SMMU_FAULT_GLOBAL_UNIMPL_CTX_BANK]       = "SMMU_FAULT_GLOBAL_UNIMPL_CTX_BANK",
    [SMMU_FAULT_GLOBAL_UNIMPL_CTX_IRQ]        = "SMMU_FAULT_GLOBAL_UNIMPL_CTX_IRQ",
    [SMMU_FAULT_GLOBAL_CFG_ACCESS]            = "SMMU_FAULT_GLOBAL_CFG_ACCESS",
    [SMMU_FAULT_GLOBAL_PERM]                  = "SMMU_FAULT_GLOBAL_PERM",
    [SMMU_FAULT_GLOBAL_EXT]                   = "SMMU_FAULT_GLOBAL_EXT",
    [SMMU_FAULT_GLOBAL_UNSUP_UPSTR_TRANS]     = "SMMU_FAULT_GLOBAL_UNSUP_UPSTR_TRANS",
    [SMMU_FAULT_GLOBAL_ADDR_SIZE]             = "SMMU_FAULT_GLOBAL_ADDR_SIZE",
};

static inline const char *smmu_event_string(SMMUv2FaultType type)
{
    if (type < ARRAY_SIZE(event_stringify)) {
        return event_stringify[type] ? event_stringify[type] : "UNKNOWN";
    } else {
        return "INVALID";
    }
}

/*  Encode an event record */
typedef struct SMMUv2Status {
    SMMUv2FaultType type;
    uint32_t sid;
    uint32_t cb;
    bool recorded;
    bool record_trans_faults;
    SMMUv2TranslationStatus status;
    hwaddr addr;
    IOMMUAccessFlags flag;
} SMMUv2Status;

typedef struct SMMUv2TransReq {
    uint64_t va;
    uint64_t tcr[3];
    uint64_t ttbr[3][2];
    uint32_t access;
    unsigned int stage;
    bool s2_enabled;
    unsigned int s2_cb;

    uint64_t pa;
    uint32_t prot;

    bool err;
} SMMUv2TransReq;

/* S2CBR fields */
#define S2CR_TYPE_TRANS     0x0
#define S2CR_TYPE_BYPASS    0x1
#define S2CR_TYPE_FAULT     0x2

/* CBAR fields */
#define CBAR_TYPE_S2_EN            0x0
#define CBAR_TYPE_S1_EN            0x1
#define CBAR_TYPE_S1_EN_S2_FAULT   0x2
#define CBAR_TYPE_NESTED_EN        0x3

static inline int oas2bits(int oas_field)
{
    switch (oas_field) {
    case 0:
        return 32;
    case 1:
        return 36;
    case 2:
        return 40;
    case 3:
        return 42;
    case 4:
        return 44;
    case 5:
        return 48;
    }
    return -1;
}

/**
 * tg2granule - Decodes the CD translation granule size field according
 * to the ttbr in use
 * @bits: TG0/1 fields
 * @ttbr: ttbr index in use
 */
static inline int tg2granule(int bits, int ttbr)
{
    switch (bits) {
    case 0:
        return ttbr ? 0  : 12;
    case 1:
        return ttbr ? 14 : 16;
    case 2:
        return ttbr ? 12 : 14;
    case 3:
        return ttbr ? 16 :  0;
    default:
        return 0;
    }
}

static inline int smmuv2_enabled(SMMUv2State *s)
{
    return !ARRAY_FIELD_EX32(s->regs, SMMU_SCR0, CLIENTPD);
}

#endif
